############################# gm5 MP reads #############################

#### Trimmed matepair data using Nextclip - August 8, 2015 ####

/fungi/taruna/shared/bin/nextclip/bin/nextclip -i /fungi/taruna/shared/Geosmithia/raw_data/gm5_mp_R1.fastq \
 -j /fungi/taruna/shared/Geosmithia/raw_data/gm5_mp_R2.fastq \
 -o /fungi/taruna/shared/Geosmithia/trim/nextclip/gm5_mp_nxtclip -t 5 -e
 
#### Determine insert sizes - August 8, 2015 ####
 
## index the reference

bwa index /fungi/taruna/shared/allpaths_final_assembly_gm5.fasta

## map adapter trimmed reads to reference

bwa mem /fungi/taruna/shared/allpaths_final_assembly_gm5.fasta /fungi/taruna/shared/Geosmithia/trim/nextclip/gm5_mp_nxtclip_A_R1.fastq \
/fungi/taruna/shared/Geosmithia/trim/nextclip/gm5_mp_nxtclip_A_R2.fastq > gm5_mp_RF.sam

## sort the sam file

samtools sort gm5_mp_RF.sam gm5_mp_RF_sorted

## run picard to determine average insert size

java -jar /opt/picard-tools-1.137/picard.jar CollectInsertSizeMetrics \
R=/fungi/taruna/shared/allpaths_final_assembly_gm5.fasta \
I=/fungi/taruna/shared/InsertSizeMetrics/BWA/gm5_mp_RF_sorted.bam \
H=gm5_MP_RF_InsertSizeHisto \
O=gm5_MP_RF_InsertSizeMetrics.txt


############################# gm5 PE reads #############################

#### run preqc to determine an approximate genome size - April 25-26, 2015 ####

sga preprocess --pe-mode 1 /fungi/taruna/shared/Geosmithia/raw_data/gm5_R1.fastq /fungi/taruna/shared/Geosmithia/raw_data/gm5_R2.fastq > gm5_info.fastq
sga index -a ropebwt --no-reverse -t 8 gm5_info.fastq
sga preqc -t 8 gm5_info.fastq > gm5.preqc
/opt/sga/src/bin/sga-preqc-report.py gm5.preqc /opt/sga/src/examples/preqc/*.preqc

#### Determine insert sizes - August 8, 2015 ####
 
## index the reference

bwa index /fungi/taruna/shared/allpaths_final_assembly_gm5.fasta

## map raw reads to reference

bwa mem /fungi/taruna/shared/allpaths_final_assembly_gm5.fasta /fungi/taruna/shared/Geosmithia/raw_data/gm5_R1.fastq \
/fungi/taruna/shared/Geosmithia/raw_data/gm5_R2.fastq > gm5.sam

## sort sam file

samtools sort gm5.sam gm5_sorted

## run Picard with sorted file

java -jar /opt/picard-tools-1.137/picard.jar CollectInsertSizeMetrics \
R=/fungi/taruna/shared/allpaths_final_assembly_gm5.fasta \
I=/fungi/taruna/shared/InsertSizeMetrics/BWA/gm5_sorted.bam \
H=gm5_InsertSizeHisto \
O=gm5_InsertSizeMetrics.txt


#### error corrected using BLESS ####

bless -read1 /fungi/taruna/shared/Geosmithia/raw_data/gm5_R1.fastq -read2 /fungi/taruna/shared/Geosmithia/raw_data/gm5_R2.fastq \
-kmerlength 21 \
-verify -notrim -prefix /fungi/taruna/geosmithia_old/bless_corr_data/gm5/gm5_bless_corr_k21


#### trim using Trimmomatic ####

java -jar /opt/Trimmomatic-0.32/trimmomatic-0.32.jar PE -threads 4 \
-baseout gm5_k21corr_trim.Phred2 \
/fungi/taruna/geosmithia_old/bless_corr_data/gm5/gm5_bless_corr_k21.1.corrected.fastq \
/fungi/taruna/geosmithia_old/bless_corr_data/gm5/gm5_bless_corr_k21.2.corrected.fastq \
ILLUMINACLIP:/opt/Trimmomatic-0.32/adapters/TruSeq3-PE-2.fa:2:30:10 \
LEADING:2 TRAILING:2 SLIDINGWINDOW:4:2 MINLEN:30
 
